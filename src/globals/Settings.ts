import { GlobalConfig } from 'payload/types'

const Settings: GlobalConfig = {
  slug: 'settings',
  label: 'Á≥ªÁªüËÆæÁΩÆ',
  admin: {
    group: '‚öôÔ∏è Á≥ªÁªüÁÆ°ÁêÜ',
  },
  access: {
    read: () => true,
    update: ({ req: { user } }) => user?.role === 'admin',
  },
  fields: [
    // ÁΩëÁ´ôÂü∫Á°Ä‰ø°ÊÅØ
    {
      name: 'siteInfo',
      type: 'group',
      label: 'üåê ÁΩëÁ´ô‰ø°ÊÅØ',
      fields: [
        {
          name: 'siteName',
          type: 'text',
          label: 'ÁΩëÁ´ôÂêçÁß∞',
          required: true,
          defaultValue: 'Êó†Â§¥Â∑•ÂÖ∑Á´ô',
        },
        {
          name: 'siteDescription',
          type: 'textarea',
          label: 'ÁΩëÁ´ôÊèèËø∞',
          maxLength: 300,
          defaultValue: 'Âü∫‰∫éÂºÄÊ∫êÊäÄÊúØÊûÑÂª∫ÁöÑ‰ºÅ‰∏öÁ∫ß SaaS Âπ≥Âè∞',
        },
        {
          name: 'siteUrl',
          type: 'text',
          label: 'ÁΩëÁ´ôURL',
          required: true,
          defaultValue: 'https://your-domain.com',
        },
        {
          name: 'logo',
          type: 'upload',
          relationTo: 'media',
          label: 'ÁΩëÁ´ôLogo',
        },
        {
          name: 'favicon',
          type: 'upload',
          relationTo: 'media',
          label: 'ÁΩëÁ´ôÂõæÊ†á',
        },
        {
          name: 'keywords',
          type: 'array',
          label: 'SEOÂÖ≥ÈîÆËØç',
          fields: [
            {
              name: 'keyword',
              type: 'text',
              required: true,
            },
          ],
          maxRows: 20,
        },
      ],
    },
    
    // ËÅîÁ≥ª‰ø°ÊÅØ
    {
      name: 'contactInfo',
      type: 'group',
      label: 'üìû ËÅîÁ≥ª‰ø°ÊÅØ',
      fields: [
        {
          name: 'email',
          type: 'email',
          label: 'ËÅîÁ≥ªÈÇÆÁÆ±',
        },
        {
          name: 'phone',
          type: 'text',
          label: 'ËÅîÁ≥ªÁîµËØù',
        },
        {
          name: 'address',
          type: 'textarea',
          label: 'ËÅîÁ≥ªÂú∞ÂùÄ',
        },
        {
          name: 'socialMedia',
          type: 'array',
          label: 'Á§æ‰∫§Â™í‰Ωì',
          fields: [
            {
              name: 'platform',
              type: 'select',
              label: 'Âπ≥Âè∞',
              options: [
                { label: 'GitHub', value: 'github' },
                { label: 'Twitter', value: 'twitter' },
                { label: 'LinkedIn', value: 'linkedin' },
                { label: 'ÂæÆÂçö', value: 'weibo' },
                { label: 'ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑', value: 'wechat' },
                { label: 'QQÁæ§', value: 'qq' },
              ],
              required: true,
            },
            {
              name: 'url',
              type: 'text',
              label: 'URL',
              required: true,
            },
            {
              name: 'username',
              type: 'text',
              label: 'Áî®Êà∑Âêç/ID',
            },
          ],
          maxRows: 10,
        },
      ],
    },
    
    // ÂàÜÊûêÈÖçÁΩÆ
    {
      name: 'analytics',
      type: 'group',
      label: 'üìä ÂàÜÊûêÈÖçÁΩÆ',
      fields: [
        {
          name: 'umamiConfig',
          type: 'group',
          label: 'UmamiÈÖçÁΩÆ',
          fields: [
            {
              name: 'enabled',
              type: 'checkbox',
              label: 'ÂêØÁî®UmamiÂàÜÊûê',
              defaultValue: true,
            },
            {
              name: 'websiteId',
              type: 'text',
              label: 'ÁΩëÁ´ôID',
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
            {
              name: 'scriptUrl',
              type: 'text',
              label: 'ËÑöÊú¨URL',
              defaultValue: '/umami.js',
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
            {
              name: 'trackingDomains',
              type: 'array',
              label: 'Ë∑üË∏™ÂüüÂêç',
              fields: [
                {
                  name: 'domain',
                  type: 'text',
                  required: true,
                },
              ],
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
          ],
        },
        {
          name: 'googleAnalytics',
          type: 'group',
          label: 'Google Analytics',
          fields: [
            {
              name: 'enabled',
              type: 'checkbox',
              label: 'ÂêØÁî®GA',
              defaultValue: false,
            },
            {
              name: 'trackingId',
              type: 'text',
              label: 'Ë∑üË∏™ID',
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
          ],
        },
      ],
    },
    
    // ÈÇÆ‰ª∂ÈÖçÁΩÆ
    {
      name: 'emailConfig',
      type: 'group',
      label: 'üìß ÈÇÆ‰ª∂ÈÖçÁΩÆ',
      fields: [
        {
          name: 'smtpConfig',
          type: 'group',
          label: 'SMTPÈÖçÁΩÆ',
          fields: [
            {
              name: 'host',
              type: 'text',
              label: 'SMTP‰∏ªÊú∫',
              defaultValue: 'smtp.gmail.com',
            },
            {
              name: 'port',
              type: 'number',
              label: 'SMTPÁ´ØÂè£',
              defaultValue: 587,
            },
            {
              name: 'secure',
              type: 'checkbox',
              label: '‰ΩøÁî®SSL',
              defaultValue: false,
            },
            {
              name: 'username',
              type: 'text',
              label: 'Áî®Êà∑Âêç',
            },
            {
              name: 'password',
              type: 'text',
              label: 'ÂØÜÁ†Å',
              admin: {
                description: 'Âª∫ËÆÆ‰ΩøÁî®Â∫îÁî®‰∏ìÁî®ÂØÜÁ†Å',
              },
            },
          ],
        },
        {
          name: 'fromEmail',
          type: 'email',
          label: 'Âèë‰ª∂‰∫∫ÈÇÆÁÆ±',
          defaultValue: 'noreply@your-domain.com',
        },
        {
          name: 'fromName',
          type: 'text',
          label: 'Âèë‰ª∂‰∫∫ÂêçÁß∞',
          defaultValue: 'Êó†Â§¥Â∑•ÂÖ∑Á´ô',
        },
        {
          name: 'replyTo',
          type: 'email',
          label: 'ÂõûÂ§çÈÇÆÁÆ±',
        },
      ],
    },
    
    // Â≠òÂÇ®ÈÖçÁΩÆ
    {
      name: 'storageConfig',
      type: 'group',
      label: 'üíæ Â≠òÂÇ®ÈÖçÁΩÆ',
      fields: [
        {
          name: 'provider',
          type: 'select',
          label: 'Â≠òÂÇ®Êèê‰æõÂïÜ',
          options: [
            { label: 'Êú¨Âú∞Â≠òÂÇ®', value: 'local' },
            { label: 'AWS S3', value: 's3' },
            { label: 'ÈòøÈáå‰∫ëOSS', value: 'oss' },
            { label: 'ËÖæËÆØ‰∫ëCOS', value: 'cos' },
            { label: 'Cloudinary', value: 'cloudinary' },
          ],
          defaultValue: 'local',
        },
        {
          name: 's3Config',
          type: 'group',
          label: 'AWS S3ÈÖçÁΩÆ',
          admin: {
            condition: (data, siblingData) => siblingData?.provider === 's3',
          },
          fields: [
            {
              name: 'bucket',
              type: 'text',
              label: 'BucketÂêçÁß∞',
            },
            {
              name: 'region',
              type: 'text',
              label: 'Âå∫Âüü',
              defaultValue: 'us-east-1',
            },
            {
              name: 'accessKeyId',
              type: 'text',
              label: 'Access Key ID',
            },
            {
              name: 'secretAccessKey',
              type: 'text',
              label: 'Secret Access Key',
            },
          ],
        },
        {
          name: 'cloudinaryConfig',
          type: 'group',
          label: 'CloudinaryÈÖçÁΩÆ',
          admin: {
            condition: (data, siblingData) => siblingData?.provider === 'cloudinary',
          },
          fields: [
            {
              name: 'cloudName',
              type: 'text',
              label: 'Cloud Name',
            },
            {
              name: 'apiKey',
              type: 'text',
              label: 'API Key',
            },
            {
              name: 'apiSecret',
              type: 'text',
              label: 'API Secret',
            },
          ],
        },
      ],
    },
    
    // ÂÆâÂÖ®ÈÖçÁΩÆ
    {
      name: 'securityConfig',
      type: 'group',
      label: 'üîê ÂÆâÂÖ®ÈÖçÁΩÆ',
      fields: [
        {
          name: 'rateLimiting',
          type: 'group',
          label: 'ÈÄüÁéáÈôêÂà∂',
          fields: [
            {
              name: 'enabled',
              type: 'checkbox',
              label: 'ÂêØÁî®ÈÄüÁéáÈôêÂà∂',
              defaultValue: true,
            },
            {
              name: 'windowMs',
              type: 'number',
              label: 'Êó∂Èó¥Á™óÂè£ (ÊØ´Áßí)',
              defaultValue: 900000, // 15ÂàÜÈíü
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
            {
              name: 'maxRequests',
              type: 'number',
              label: 'ÊúÄÂ§ßËØ∑Ê±ÇÊï∞',
              defaultValue: 100,
              admin: {
                condition: (data, siblingData) => siblingData?.enabled,
              },
            },
          ],
        },
        {
          name: 'corsConfig',
          type: 'group',
          label: 'CORSÈÖçÁΩÆ',
          fields: [
            {
              name: 'allowedOrigins',
              type: 'array',
              label: 'ÂÖÅËÆ∏ÁöÑÊ∫ê',
              fields: [
                {
                  name: 'origin',
                  type: 'text',
                  required: true,
                },
              ],
              defaultValue: [{ origin: '*' }],
            },
            {
              name: 'allowCredentials',
              type: 'checkbox',
              label: 'ÂÖÅËÆ∏Âá≠ËØÅ',
              defaultValue: true,
            },
          ],
        },
      ],
    },
    
    // ÂäüËÉΩÂºÄÂÖ≥
    {
      name: 'features',
      type: 'group',
      label: 'üéõÔ∏è ÂäüËÉΩÂºÄÂÖ≥',
      fields: [
        {
          name: 'userRegistration',
          type: 'checkbox',
          label: 'ÂÖÅËÆ∏Áî®Êà∑Ê≥®ÂÜå',
          defaultValue: true,
        },
        {
          name: 'guestAccess',
          type: 'checkbox',
          label: 'ÂÖÅËÆ∏ËÆøÂÆ¢‰ΩøÁî®',
          defaultValue: true,
        },
        {
          name: 'fileUpload',
          type: 'checkbox',
          label: 'ÂÖÅËÆ∏Êñá‰ª∂‰∏ä‰º†',
          defaultValue: true,
        },
        {
          name: 'apiAccess',
          type: 'checkbox',
          label: 'ÂêØÁî®APIËÆøÈóÆ',
          defaultValue: true,
        },
        {
          name: 'maintenanceMode',
          type: 'checkbox',
          label: 'Áª¥Êä§Ê®°Âºè',
          defaultValue: false,
        },
        {
          name: 'maintenanceMessage',
          type: 'richText',
          label: 'Áª¥Êä§ÊèêÁ§∫‰ø°ÊÅØ',
          admin: {
            condition: (data, siblingData) => siblingData?.maintenanceMode,
          },
        },
      ],
    },
    
    // Á≥ªÁªü‰ø°ÊÅØ
    {
      name: 'systemInfo',
      type: 'group',
      label: 'üìã Á≥ªÁªü‰ø°ÊÅØ',
      admin: {
        readOnly: true,
      },
      fields: [
        {
          name: 'version',
          type: 'text',
          label: 'Á≥ªÁªüÁâàÊú¨',
          defaultValue: '1.0.0',
        },
        {
          name: 'lastUpdated',
          type: 'date',
          label: 'ÊúÄÂêéÊõ¥Êñ∞',
          defaultValue: () => new Date(),
        },
        {
          name: 'environment',
          type: 'select',
          label: 'ËøêË°åÁéØÂ¢É',
          options: [
            { label: 'ÂºÄÂèë', value: 'development' },
            { label: 'ÊµãËØï', value: 'staging' },
            { label: 'Áîü‰∫ß', value: 'production' },
          ],
          defaultValue: 'production',
        },
      ],
    },
  ],
  hooks: {
    beforeChange: [
      ({ data }) => {
        // Ëá™Âä®Êõ¥Êñ∞ÊúÄÂêé‰øÆÊîπÊó∂Èó¥
        if (data.systemInfo) {
          data.systemInfo.lastUpdated = new Date()
        }
        return data
      },
    ],
  },
}

export default Settings
